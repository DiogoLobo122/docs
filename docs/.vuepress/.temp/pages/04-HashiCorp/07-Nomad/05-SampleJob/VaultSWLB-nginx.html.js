export const data = JSON.parse("{\"key\":\"v-6e88b7d8\",\"path\":\"/04-HashiCorp/07-Nomad/05-SampleJob/VaultSWLB-nginx.html\",\"title\":\"Vault SWLB용도의 nginx\",\"lang\":\"ko-KR\",\"frontmatter\":{\"description\":\"Nomad Sample\",\"tag\":[\"Nomad\",\"Sample\",\"Job\",\"Vault\",\"SWLB\"],\"head\":[[\"meta\",{\"property\":\"og:url\",\"content\":\"https://vuepress-theme-hope-docs-demo.netlify.app/04-HashiCorp/07-Nomad/05-SampleJob/VaultSWLB-nginx.html\"}],[\"meta\",{\"property\":\"og:site_name\",\"content\":\"docmoa\"}],[\"meta\",{\"property\":\"og:title\",\"content\":\"Vault SWLB용도의 nginx\"}],[\"meta\",{\"property\":\"og:description\",\"content\":\"Nomad Sample\"}],[\"meta\",{\"property\":\"og:type\",\"content\":\"article\"}],[\"meta\",{\"property\":\"og:locale\",\"content\":\"ko-KR\"}],[\"meta\",{\"property\":\"article:tag\",\"content\":\"Nomad\"}],[\"meta\",{\"property\":\"article:tag\",\"content\":\"Sample\"}],[\"meta\",{\"property\":\"article:tag\",\"content\":\"Job\"}],[\"meta\",{\"property\":\"article:tag\",\"content\":\"Vault\"}],[\"meta\",{\"property\":\"article:tag\",\"content\":\"SWLB\"}],[\"script\",{\"type\":\"application/ld+json\"},\"{\\\"@context\\\":\\\"https://schema.org\\\",\\\"@type\\\":\\\"Article\\\",\\\"headline\\\":\\\"Vault SWLB용도의 nginx\\\",\\\"image\\\":[\\\"\\\"],\\\"dateModified\\\":null,\\\"author\\\":[]}\"]]},\"headers\":[],\"git\":{},\"readingTime\":{\"minutes\":0.53,\"words\":159},\"filePathRelative\":\"04-HashiCorp/07-Nomad/05-SampleJob/VaultSWLB-nginx.md\",\"excerpt\":\"<h1> Vault SWLB용도의 nginx</h1>\\n<ul>\\n<li>Vault의 HA구성 시에는 LB가 필요한데, LB대용으로 SWLB를 이용하여 Vault를 사용할 수 있다.\\n<ul>\\n<li>해당 페이지에서는 nginx를 사용하였지만, HAproxy도 비슷하게 사용이 가능하다.</li>\\n</ul>\\n</li>\\n</ul>\\n<h1> nginx job 파일</h1>\\n<div class=\\\"language-hcl line-numbers-mode\\\" data-ext=\\\"hcl\\\"><pre class=\\\"language-hcl\\\"><code>job <span class=\\\"token string\\\">\\\"nginx\\\"</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token property\\\">datacenters</span> <span class=\\\"token punctuation\\\">=</span> <span class=\\\"token punctuation\\\">[</span><span class=\\\"token string\\\">\\\"dc1\\\"</span><span class=\\\"token punctuation\\\">]</span>\\n\\n  group <span class=\\\"token string\\\">\\\"nginx\\\"</span> <span class=\\\"token punctuation\\\">{</span>\\n\\n    <span class=\\\"token keyword\\\">constraint</span> <span class=\\\"token punctuation\\\">{</span>\\n      <span class=\\\"token property\\\">attribute</span> <span class=\\\"token punctuation\\\">=</span> <span class=\\\"token string\\\">\\\"<span class=\\\"token interpolation\\\"><span class=\\\"token punctuation\\\">$</span><span class=\\\"token punctuation\\\">{</span>attr<span class=\\\"token punctuation\\\">.</span>unique<span class=\\\"token punctuation\\\">.</span>hostname<span class=\\\"token punctuation\\\">}</span></span>\\\"</span>\\n      <span class=\\\"token property\\\">value</span>     <span class=\\\"token punctuation\\\">=</span> <span class=\\\"token string\\\">\\\"slave0\\\"</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n\\n    <span class=\\\"token comment\\\">#Vault tls가 있고 nomad client hcl 파일에 host volume이 명시되어 있는 설정 값</span>\\n    volume <span class=\\\"token string\\\">\\\"cert-data\\\"</span> <span class=\\\"token punctuation\\\">{</span>\\n      <span class=\\\"token property\\\">type</span>      <span class=\\\"token punctuation\\\">=</span> <span class=\\\"token string\\\">\\\"host\\\"</span>\\n      <span class=\\\"token property\\\">source</span>    <span class=\\\"token punctuation\\\">=</span> <span class=\\\"token string\\\">\\\"cert-data\\\"</span>\\n      <span class=\\\"token property\\\">read_only</span> <span class=\\\"token punctuation\\\">=</span> <span class=\\\"token boolean\\\">false</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n\\n    <span class=\\\"token comment\\\">#실패 없이 되라고 행운의 숫자인 7을 4번 줌</span>\\n    <span class=\\\"token keyword\\\">network</span> <span class=\\\"token punctuation\\\">{</span>\\n      port <span class=\\\"token string\\\">\\\"http\\\"</span> <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token property\\\">to</span>     <span class=\\\"token punctuation\\\">=</span> <span class=\\\"token number\\\">7777</span>\\n        <span class=\\\"token property\\\">static</span> <span class=\\\"token punctuation\\\">=</span> <span class=\\\"token number\\\">7777</span>\\n      <span class=\\\"token punctuation\\\">}</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n\\n    <span class=\\\"token keyword\\\">service</span> <span class=\\\"token punctuation\\\">{</span>\\n      <span class=\\\"token property\\\">name</span> <span class=\\\"token punctuation\\\">=</span> <span class=\\\"token string\\\">\\\"nginx\\\"</span>\\n      <span class=\\\"token property\\\">port</span> <span class=\\\"token punctuation\\\">=</span> <span class=\\\"token string\\\">\\\"http\\\"</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n\\n    task <span class=\\\"token string\\\">\\\"nginx\\\"</span> <span class=\\\"token punctuation\\\">{</span>\\n      <span class=\\\"token property\\\">driver</span> <span class=\\\"token punctuation\\\">=</span> <span class=\\\"token string\\\">\\\"docker\\\"</span>\\n\\n      <span class=\\\"token keyword\\\">volume_mount</span> <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token property\\\">volume</span>      <span class=\\\"token punctuation\\\">=</span> <span class=\\\"token string\\\">\\\"cert-data\\\"</span>\\n        <span class=\\\"token property\\\">destination</span> <span class=\\\"token punctuation\\\">=</span> <span class=\\\"token string\\\">\\\"/usr/local/cert\\\"</span>\\n      <span class=\\\"token punctuation\\\">}</span>\\n\\n      <span class=\\\"token keyword\\\">config</span> <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token property\\\">image</span> <span class=\\\"token punctuation\\\">=</span> <span class=\\\"token string\\\">\\\"nginx\\\"</span>\\n\\n        <span class=\\\"token property\\\">ports</span> <span class=\\\"token punctuation\\\">=</span> <span class=\\\"token punctuation\\\">[</span><span class=\\\"token string\\\">\\\"http\\\"</span><span class=\\\"token punctuation\\\">]</span>\\n        <span class=\\\"token property\\\">volumes</span> <span class=\\\"token punctuation\\\">=</span> <span class=\\\"token punctuation\\\">[</span>\\n          <span class=\\\"token string\\\">\\\"local:/etc/nginx/conf.d\\\"</span>,\\n\\n        <span class=\\\"token punctuation\\\">]</span>\\n      <span class=\\\"token punctuation\\\">}</span>\\n      <span class=\\\"token keyword\\\">template</span> <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token property\\\">data</span> <span class=\\\"token punctuation\\\">=</span> <span class=\\\"token heredoc string\\\">&lt;&lt;EOF        \\n#Vault는 active서버 1대외에는 전부 standby상태이며 \\n#서비스 호출 시(write)에는 active 서비스만 호출해야함으로 아래와 같이 consul에서 서비스를 불러옴\\n\\nupstream backend {\\n{{ range service \\\"active.vault\\\" }}\\n  server {{ .Address }}:{{ .Port }};\\n{{ else }}server 127.0.0.1:65535; # force a 502\\n{{ end }}\\n}\\n\\nserver {\\n   listen 7777 ssl;\\n   #위에서 nomad host volume을 mount한 cert를 가져옴\\n   ssl on;\\n   ssl_certificate /usr/local/cert/vault/global-client-vault-0.pem;\\n   ssl_certificate_key /usr/local/cert/vault/global-client-vault-0-key.pem;\\n   #vault ui 접근 시 / -&gt; /ui redirect되기 때문에 location이 /외에는 되지 않는다.\\n   location / {\\n      proxy_pass https://backend;\\n   }\\n}\\nEOF</span>\\n\\n        <span class=\\\"token property\\\">destination</span>   <span class=\\\"token punctuation\\\">=</span> <span class=\\\"token string\\\">\\\"local/load-balancer.conf\\\"</span>\\n        <span class=\\\"token property\\\">change_mode</span>   <span class=\\\"token punctuation\\\">=</span> <span class=\\\"token string\\\">\\\"signal\\\"</span>\\n        <span class=\\\"token property\\\">change_signal</span> <span class=\\\"token punctuation\\\">=</span> <span class=\\\"token string\\\">\\\"SIGHUP\\\"</span>\\n      <span class=\\\"token punctuation\\\">}</span>\\n      <span class=\\\"token keyword\\\">resources</span> <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token property\\\">cpu</span> <span class=\\\"token punctuation\\\">=</span> <span class=\\\"token number\\\">100</span>\\n        <span class=\\\"token property\\\">memory</span> <span class=\\\"token punctuation\\\">=</span> <span class=\\\"token number\\\">201</span>\\n      <span class=\\\"token punctuation\\\">}</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n</code></pre><div class=\\\"line-numbers\\\" aria-hidden=\\\"true\\\"><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div></div></div>\",\"copyright\":{\"license\":\"CC BY-NC-ND 4.0 Licensed | ⓒ 2021-present docmoa™ contributers all rights reserved.\"}}")

if (import.meta.webpackHot) {
  import.meta.webpackHot.accept()
  if (__VUE_HMR_RUNTIME__.updatePageData) {
    __VUE_HMR_RUNTIME__.updatePageData(data)
  }
}

if (import.meta.hot) {
  import.meta.hot.accept(({ data }) => {
    __VUE_HMR_RUNTIME__.updatePageData(data)
  })
}
