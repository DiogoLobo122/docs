export const data = JSON.parse("{\"key\":\"v-37c71957\",\"path\":\"/04-HashiCorp/07-Nomad/05-SampleJob/nginx.html\",\"title\":\"nginx\",\"lang\":\"ko-KR\",\"frontmatter\":{\"description\":\"Nomad Sample\",\"tag\":[\"Nomad\",\"Sample\",\"Job\",\"reverse proxy\",\"consul service discovery\"],\"head\":[[\"meta\",{\"property\":\"og:url\",\"content\":\"https://vuepress-theme-hope-docs-demo.netlify.app/04-HashiCorp/07-Nomad/05-SampleJob/nginx.html\"}],[\"meta\",{\"property\":\"og:site_name\",\"content\":\"docmoa\"}],[\"meta\",{\"property\":\"og:title\",\"content\":\"nginx\"}],[\"meta\",{\"property\":\"og:description\",\"content\":\"Nomad Sample\"}],[\"meta\",{\"property\":\"og:type\",\"content\":\"article\"}],[\"meta\",{\"property\":\"og:locale\",\"content\":\"ko-KR\"}],[\"meta\",{\"property\":\"article:tag\",\"content\":\"Nomad\"}],[\"meta\",{\"property\":\"article:tag\",\"content\":\"Sample\"}],[\"meta\",{\"property\":\"article:tag\",\"content\":\"Job\"}],[\"meta\",{\"property\":\"article:tag\",\"content\":\"reverse proxy\"}],[\"meta\",{\"property\":\"article:tag\",\"content\":\"consul service discovery\"}],[\"script\",{\"type\":\"application/ld+json\"},\"{\\\"@context\\\":\\\"https://schema.org\\\",\\\"@type\\\":\\\"Article\\\",\\\"headline\\\":\\\"nginx\\\",\\\"image\\\":[\\\"\\\"],\\\"dateModified\\\":null,\\\"author\\\":[]}\"]]},\"headers\":[],\"git\":{},\"readingTime\":{\"minutes\":0.67,\"words\":200},\"filePathRelative\":\"04-HashiCorp/07-Nomad/05-SampleJob/nginx.md\",\"excerpt\":\"<h1> nginx</h1>\\n<ul>\\n<li>nomad와 consul로 cluster로 구성되어 있는 환경에 L4이후에 nomad로 LB를 해야할 경우 사용\\n<ul>\\n<li>nginx server_name설정에서 도메인을 받아오고 location에서는 각각의 서브도메인 별로 reverse proxy 동작\\n<ul>\\n<li>reverse proxy(up stream)에서는 각각의 consul의 등록된 서비스 호출</li>\\n</ul>\\n</li>\\n</ul>\\n</li>\\n</ul>\\n<div class=\\\"language-hcl line-numbers-mode\\\" data-ext=\\\"hcl\\\"><pre class=\\\"language-hcl\\\"><code>job <span class=\\\"token string\\\">\\\"nginx\\\"</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token property\\\">datacenters</span> <span class=\\\"token punctuation\\\">=</span> <span class=\\\"token punctuation\\\">[</span><span class=\\\"token string\\\">\\\"dc1\\\"</span><span class=\\\"token punctuation\\\">]</span>\\n\\n  group <span class=\\\"token string\\\">\\\"nginx\\\"</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token comment\\\">//인증서는 host volume에 업로드</span>\\n    volume <span class=\\\"token string\\\">\\\"certs\\\"</span> <span class=\\\"token punctuation\\\">{</span>\\n      <span class=\\\"token property\\\">type</span>      <span class=\\\"token punctuation\\\">=</span> <span class=\\\"token string\\\">\\\"host\\\"</span>\\n      <span class=\\\"token property\\\">source</span>    <span class=\\\"token punctuation\\\">=</span> <span class=\\\"token string\\\">\\\"certs\\\"</span>\\n      <span class=\\\"token property\\\">read_only</span> <span class=\\\"token punctuation\\\">=</span> <span class=\\\"token boolean\\\">true</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n \\n    <span class=\\\"token keyword\\\">network</span> <span class=\\\"token punctuation\\\">{</span>\\n      port <span class=\\\"token string\\\">\\\"http\\\"</span> <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token property\\\">static</span>  <span class=\\\"token punctuation\\\">=</span> <span class=\\\"token number\\\">80</span>\\n        <span class=\\\"token property\\\">to</span>      <span class=\\\"token punctuation\\\">=</span> <span class=\\\"token number\\\">80</span>\\n      <span class=\\\"token punctuation\\\">}</span>\\n      port <span class=\\\"token string\\\">\\\"https\\\"</span> <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token property\\\">to</span>      <span class=\\\"token punctuation\\\">=</span> <span class=\\\"token number\\\">443</span>\\n        <span class=\\\"token property\\\">static</span>  <span class=\\\"token punctuation\\\">=</span> <span class=\\\"token number\\\">443</span>\\n      <span class=\\\"token punctuation\\\">}</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n\\n    <span class=\\\"token keyword\\\">service</span> <span class=\\\"token punctuation\\\">{</span>\\n      <span class=\\\"token property\\\">name</span> <span class=\\\"token punctuation\\\">=</span> <span class=\\\"token string\\\">\\\"nginx\\\"</span>\\n      <span class=\\\"token property\\\">port</span> <span class=\\\"token punctuation\\\">=</span> <span class=\\\"token string\\\">\\\"http\\\"</span>\\n      <span class=\\\"token property\\\">tags</span> <span class=\\\"token punctuation\\\">=</span> <span class=\\\"token punctuation\\\">[</span><span class=\\\"token string\\\">\\\"web\\\"</span><span class=\\\"token punctuation\\\">]</span>\\n      <span class=\\\"token keyword\\\">check</span> <span class=\\\"token punctuation\\\">{</span>    \\n        <span class=\\\"token property\\\">type</span>     <span class=\\\"token punctuation\\\">=</span> <span class=\\\"token string\\\">\\\"tcp\\\"</span>\\n        <span class=\\\"token property\\\">port</span>     <span class=\\\"token punctuation\\\">=</span> <span class=\\\"token string\\\">\\\"http\\\"</span>\\n        <span class=\\\"token property\\\">interval</span> <span class=\\\"token punctuation\\\">=</span> <span class=\\\"token string\\\">\\\"2s\\\"</span>\\n        <span class=\\\"token property\\\">timeout</span>  <span class=\\\"token punctuation\\\">=</span> <span class=\\\"token string\\\">\\\"2s\\\"</span>\\n      <span class=\\\"token punctuation\\\">}</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n\\n    task <span class=\\\"token string\\\">\\\"server\\\"</span> <span class=\\\"token punctuation\\\">{</span>\\n\\n      <span class=\\\"token property\\\">driver</span> <span class=\\\"token punctuation\\\">=</span> <span class=\\\"token string\\\">\\\"docker\\\"</span>\\n\\n      <span class=\\\"token keyword\\\">volume_mount</span> <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token property\\\">volume</span>      <span class=\\\"token punctuation\\\">=</span> <span class=\\\"token string\\\">\\\"certs\\\"</span>\\n        <span class=\\\"token property\\\">destination</span> <span class=\\\"token punctuation\\\">=</span> <span class=\\\"token string\\\">\\\"/etc/nginx/certs\\\"</span>\\n      <span class=\\\"token punctuation\\\">}</span>\\n\\n      <span class=\\\"token keyword\\\">config</span> <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token property\\\">image</span> <span class=\\\"token punctuation\\\">=</span> <span class=\\\"token string\\\">\\\"nginx\\\"</span>\\n        <span class=\\\"token property\\\">ports</span> <span class=\\\"token punctuation\\\">=</span> <span class=\\\"token punctuation\\\">[</span><span class=\\\"token string\\\">\\\"http\\\"</span>,<span class=\\\"token string\\\">\\\"https\\\"</span><span class=\\\"token punctuation\\\">]</span>\\n        <span class=\\\"token comment\\\">#ports = [\\\"http\\\",\\\"https\\\"]</span>\\n        <span class=\\\"token property\\\">volumes</span> <span class=\\\"token punctuation\\\">=</span> <span class=\\\"token punctuation\\\">[</span>\\n          <span class=\\\"token string\\\">\\\"local:/etc/nginx/conf.d\\\"</span>,\\n        <span class=\\\"token punctuation\\\">]</span>\\n      <span class=\\\"token punctuation\\\">}</span>\\n\\n      <span class=\\\"token keyword\\\">template</span> <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token property\\\">data</span> <span class=\\\"token punctuation\\\">=</span> <span class=\\\"token heredoc string\\\">&lt;&lt;EOF\\n\\nupstream login.shoping.co.kr {\\n{{ range service \\\"login\\\" }}\\n  server {{ .Address }}:{{ .Port }};\\n{{ else }}server 127.0.0.1:65535; # force a 502\\n{{ end }}\\n}\\nupstream singup.shoping.co.kr {\\n{{ range service \\\"signup\\\" }}\\n  server {{ .Address }}:{{ .Port }};\\n{{ else }}server 127.0.0.1:65535; # force a 502\\n{{ end }}\\n}\\nupstream main.shoping.co.kr {\\n{{ range service \\\"main\\\" }}\\n  server {{ .Address }}:{{ .Port }};\\n{{ else }}server 127.0.0.1:65535; # force a 502\\n{{ end }}\\n}\\n\\nserver {\\n   listen 80;\\n   listen 443 ssl;\\n   //domain 및 subdomain호출\\n   server_name *.shoping.co.kr;\\n   ssl_certificate \\\"/etc/nginx/certs/server.pem\\\";\\n   ssl_certificate_key \\\"/etc/nginx/certs/server.key\\\";\\n   proxy_read_timeout      300;\\n   proxy_buffers           64 16k;\\n\\n   //각 sub도메인별\\n   location / {\\n      if ($host = login.shoping.co.kr) {\\n        proxy_pass login.shoping.co.kr;\\n      }\\n      if ($host = singup.shoping.co.kr) {\\n        proxy_pass singup.shoping.co.kr;\\n      }\\n      if ($host !~ \\\"(.*main)\\\") {\\n        proxy_pass main.shoping.co.kr;\\n      }\\n   }\\n}\\n\\n\\n\\nEOF</span>\\n\\n        <span class=\\\"token property\\\">destination</span>   <span class=\\\"token punctuation\\\">=</span> <span class=\\\"token string\\\">\\\"local/load-balancer.conf\\\"</span>\\n        <span class=\\\"token property\\\">change_mode</span>   <span class=\\\"token punctuation\\\">=</span> <span class=\\\"token string\\\">\\\"signal\\\"</span>\\n        <span class=\\\"token property\\\">change_signal</span> <span class=\\\"token punctuation\\\">=</span> <span class=\\\"token string\\\">\\\"SIGHUP\\\"</span>\\n      <span class=\\\"token punctuation\\\">}</span>\\n      <span class=\\\"token keyword\\\">resources</span> <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token property\\\">cpu</span> <span class=\\\"token punctuation\\\">=</span> <span class=\\\"token number\\\">2000</span>\\n        <span class=\\\"token property\\\">memory</span> <span class=\\\"token punctuation\\\">=</span> <span class=\\\"token number\\\">2000</span>\\n      <span class=\\\"token punctuation\\\">}</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n\\n\\n</code></pre><div class=\\\"line-numbers\\\" aria-hidden=\\\"true\\\"><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div></div></div>\",\"copyright\":{\"license\":\"CC BY-NC-ND 4.0 Licensed | ⓒ 2021-present docmoa™ contributers all rights reserved.\"}}")

if (import.meta.webpackHot) {
  import.meta.webpackHot.accept()
  if (__VUE_HMR_RUNTIME__.updatePageData) {
    __VUE_HMR_RUNTIME__.updatePageData(data)
  }
}

if (import.meta.hot) {
  import.meta.hot.accept(({ data }) => {
    __VUE_HMR_RUNTIME__.updatePageData(data)
  })
}
